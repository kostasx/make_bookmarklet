// Generated by CoffeeScript 1.10.0
var bookmarklet, filename, fs, pbcopy, source;

fs = require('fs');

filename = process.argv.slice(2)[0];

source = fs.readFileSync(filename, "utf8");

pbcopy = function(data) {
  var proc;
  proc = require('child_process').spawn('pbcopy');
  proc.stdin.write(data);
  return proc.stdin.end();
};

bookmarklet = source.replace(/^\s?javascript:/gm, "");

bookmarklet = bookmarklet.replace(/^\s*\/\/.+/gm, "");

bookmarklet = bookmarklet.replace(/^\s*\/\*[^]+?\*\/\n?/gm, "");

bookmarklet = bookmarklet.replace(/\t/g, " ");

bookmarklet = bookmarklet.replace(/[ ]{2,}/g, " ");

bookmarklet = bookmarklet.replace(/^\s+/gm, "");

bookmarklet = bookmarklet.replace(/\s+$/gm, "");

bookmarklet = bookmarklet.replace(/\n/gm, "");

bookmarklet = "javascript:" + encodeURIComponent(bookmarklet);

console.log(bookmarklet);

if (/^darwin/.test(process.platform)) {
  pbcopy(bookmarklet);
}
